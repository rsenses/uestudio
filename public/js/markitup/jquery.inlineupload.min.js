var InlineUpload={dialog:null,block:"",offset:{},options:{container_class:"markItUpInlineUpload",form_id:"inline_upload_form",action:"/files/upload",inputs:{alt:{label:"Alt text",id:"inline_upload_alt",name:"inline_upload_alt"},target:{label:"Target",id:"inline_upload_target",name:"inline_upload_target"},onclick:{label:"Onclick",id:"inline_upload_onclick",name:"inline_upload_onclick"},rel:{label:"Rel",id:"inline_upload_rel",name:"inline_upload_rel"},file:{label:"File",id:"inline_upload_file",name:"inline_upload_file"}},submit:{id:"inline_upload_submit",value:"upload"},close:"inline_upload_close",iframe:"inline_upload_iframe"},image:function(i){var o=this;this.offset=$(i.textarea).prev(".markItUpHeader").offset(),this.webname=$("#web").val(),this.dialog=$(['<div class="',this.options.container_class,'"><div><form id="',this.options.form_id,'" action="',this.options.action,'" target="',this.options.iframe,'" method="post" enctype="multipart/form-data"><input type="hidden" name="webname" class="markitup-webname" value="',this.webname,'"><div class="form-group"><label class="control-label" for="',this.options.inputs.alt.id,'">',this.options.inputs.alt.label,'</label><input name="',this.options.inputs.alt.name,'" id="',this.options.inputs.alt.id,'" type="text" class="form-control"></div><div class="form-group"><label class="control-label" for="',this.options.inputs.file.id,'">',this.options.inputs.file.label,'</label><input name="',this.options.inputs.file.name,'" id="',this.options.inputs.file.id,'" type="file"></div><div class="form-group"><input id="',this.options.submit.id,'" type="button" class="btn btn-info btn-block" value="',this.options.submit.value,'"></div></form><div id="',this.options.close,'"><i class="fa fa-times"></i></div><iframe id="',this.options.iframe,'" name="',this.options.iframe,'" src="about:blank"></iframe></div></div>'].join("")).appendTo(document.body).hide().css("top",this.offset.top).css("left",this.offset.left),$("#"+this.options.submit.id).click(function(){if(""==$("#inline_upload_file1").val())return alert("Please select a file to upload"),!1;upload=!0,$("#"+o.options.form_id).submit().fadeTo("fast",.2)}),$("#"+this.options.close).click(this.cleanUp),$("#"+this.options.iframe).bind("load",function(){var i=document.getElementById(""+o.options.iframe).contentWindow.document.body.innerHTML;if(console.log(i),""!==i){var t=jQuery.parseJSON(i.replace(/<(?:.|\n)*?>/gm,""));"success"==t.status?(this.block=['<img src="',t.src,'" alt="',$("#"+o.options.inputs.alt.id).val(),'">'],o.cleanUp(),$.markItUp({replaceWith:this.block.join("")})):(console.log(t.msg),o.cleanUp())}}),this.dialog.fadeIn("slow")},file:function(o){var e=this;this.offset=$(o.textarea).prev(".markItUpHeader").offset(),this.webname=$("#web").val(),this.dialog=$(['<div class="',this.options.container_class,'"><div><form id="',this.options.form_id,'" action="',this.options.action,'" target="',this.options.iframe,'" method="post" enctype="multipart/form-data"><input type="hidden" name="webname" class="markitup-webname" value="',this.webname,'"><div class="form-group"><label class="control-label" for="',this.options.inputs.rel.id,'">',this.options.inputs.rel.label,'</label><input name="',this.options.inputs.rel.name,'" id="',this.options.inputs.rel.id,'" type="text" class="form-control"></div><div class="form-group"><label class="control-label" for="',this.options.inputs.target.id,'">',this.options.inputs.target.label,'</label><input name="',this.options.inputs.target.name,'" id="',this.options.inputs.target.id,'" type="text" class="form-control"></div><div class="form-group"><label class="control-label" for="',this.options.inputs.onclick.id,'">',this.options.inputs.onclick.label,'</label><input name="',this.options.inputs.onclick.name,'" id="',this.options.inputs.onclick.id,'" type="text" class="form-control"></div><div class="form-group"><label class="control-label" for="',this.options.inputs.file.id,'">',this.options.inputs.file.label,'</label><input name="',this.options.inputs.file.name,'" id="',this.options.inputs.file.id,'" type="file"></div><div class="form-group"><input id="',this.options.submit.id,'" type="button" class="btn btn-info btn-block" value="',this.options.submit.value,'"></div></form><div id="',this.options.close,'"></div><iframe id="',this.options.iframe,'" name="',this.options.iframe,'" src="about:blank"></iframe></div></div>'].join("")).appendTo(document.body).hide().css("top",this.offset.top).css("left",this.offset.left),$("#"+this.options.submit.id).click(function(){if(""==$("#inline_upload_file1").val())return alert("Please select a file to upload"),!1;upload=!0,$("#"+e.options.form_id).submit().fadeTo("fast",.2)}),$("#"+this.options.close).click(this.cleanUp),$("#"+this.options.iframe).bind("load",function(){var i=document.getElementById(""+e.options.iframe).contentWindow.document.body.innerHTML;if(""!==i){var t=jQuery.parseJSON(i.replace(/<(?:.|\n)*?>/gm,""));console.log(t),"success"==t.status?(this.block=['<a href="',t.src,'" target="',$("#"+e.options.inputs.target.id).val(),'" rel="',$("#"+e.options.inputs.rel.id).val(),'" onclick="envioSC(\'',$("#"+e.options.inputs.onclick.id).val(),"');gtag('event', 'link', {'event_category': '",$("#"+e.options.inputs.onclick.id).val(),"'});\">",o.selection,"</a>"],e.cleanUp(),$.markItUp({replaceWith:this.block.join("")})):(console.log("error"),console.log(t.msg),e.cleanUp())}}),this.dialog.fadeIn("slow")},cleanUp:function(){InlineUpload.dialog.fadeOut().remove()}};
